<html>
<head>
<title>Hypothesis utilities</title>   
<style>
body { font-family:verdana; margin:.75in; }
.small { font-size:smaller }
</style>
<meta name="citation_pdf_url" content="h.pdf">
</head>

<body>
<h1>Tools for working with Hypothesis</h1>

<h2>View and export annotations by</h2>

<ul>
<li> <a href="http://jonudell.net/h/facet.html?facet=user&search=jeremydean">user</a>
<li> <a href="http://jonudell.net/h/facet.html?facet=group">group</a>
<li> <a href="http://jonudell.net/h/facet.html?facet=tag&search=nextprez">tag</a>
<li> <a href="http://jonudell.net/h/facet.html?facet=uri&search=http://example.com">uri</a>
<li> <a href="http://jonudell.net/h/facet.html?facet=any">any</a>
</ul>

<p class="small"><a href="https://github.com/judell/h_export">https://github.com/judell/h_export</a></p>

<h2>Slack notifier</h2>

<p>
<img style="width:500px;border-width:thin;border-style:solid;border-color:black" src="slack_notification.jpg">
</p>

<p>
We're working with a few groups of users to explore how this should work and refine it. If you'd like to try this prototype service, <a href="mailto:judell@hypothes.is?subject=Slack notifier">contact me</a>. 
</p>

<h2>Hypothesis query builder</h2>

<p>fill in fields, click the link</p>

<form onchange="search()">
<table>
<tr><td style="text-align:right">url: </td> <td> <input id="url" size="100" > </td></tr>
<tr><td>user: </td> <td> <input id="user" > </td></tr>
<tr><td>tags: </td> <td> <input id="tags" > <span style="font-size:smaller">Use commas to separate multiple tags. </span></td> </tr>
</table>
</form>

<form onchange="search()">
<input name="output_choice" checked type="radio" id="stream"> stream
<input name="output_choice" type="radio" id="api"> api
</form>

<p>
<a title="Try it!" target="_new" id="query" href="https://hypothes.is/stream?q=">https://hypothes.is/stream?q=</a>
</p>

<a name="bookmarklets"/>

<h2>Bookmarklets for working with Hypothesis</h2>

<p>
ClinGen: Streamline the task of curating info about a gene: 

<a href="javascript:(function(){var d=document; var s1=d.createElement('script');s1.setAttribute('src','https://jonudell.info/hlib/StandaloneAnchoring.js');d.head.appendChild(s1); var s2=d.createElement('script');s2.setAttribute('src','https://jonudell.info/h/ClinGen/gather.js');d.head.appendChild(s2);})();">ClinGen</a>

</p>


<p>
Experimental client, activated using a via bookmarklet

<a href="javascript:(function(){location.href='https://via.jonudell.info/'+location.href}())">x-client</a>


<p>
/a/ANNOTATION_ID -> /api/annotations/ANNOTATION_ID: 

<a href="javascript:(function(){location.href=location.href.replace('/a/','/api/annotations/')}());">raw annotation</a>


<p>
arxiv: query for H annotations (from an abstract page like https://arxiv.org/abs/1606.02960)
<a href="javascript:(function(){var%20script=document.createElement('script');%20script.type='text/javascript';%20script.src='https://jonudell.info/h/arxiv.js';%20document.getElementsByTagName('head')[0].appendChild(script);})();">arxiv</a> 

<p>
biorxiv: query for H annotations (demo only, works with http://biorxiv.org/content/early/2015/10/26/017756)
<a href="javascript:(function(){var%20script=document.createElement('script');%20script.type='text/javascript';%20script.src='https://jonudell.info/h/biorxiv.js';%20document.getElementsByTagName('head')[0].appendChild(script);})();">biorxiv</a> 


<p>
Pagefit: Try to push the page out of the way of the Hypothesis sidebar.

<a href="javascript:(function(){var s=document.createElement('script');s.src='https://jonudell.info/h/pagefit.js';document.body.appendChild(s)}())">pagefit</a>
</p>

<p>
FactCheck: Gather claimReview metadata from a [snopes|politifact|factcheck|wapo] fact-check page, formulate an annotation, post it to the target of the fact-check page.

<a href="javascript:(function(){var d=document,s=d.createElement('script');s.setAttribute('src','https://jonudell.info/h/FactCheck/gather.js');d.body.appendChild(s)})();">FactCheck</a>
</p>

<p>
ClaimReview: Create/edit a claimReview record based on a selected target claim, form an annotation, post it to the targe.

<a href="javascript:(function(){var d=document,s=d.createElement('script');s.setAttribute('src','https://jonudell.info/h/ClaimReview/gather.js');d.body.appendChild(s)})();">ClaimReview</a>
</p>

<p>
Activity pages expander

<a href="javascript:(function(){var cards = document.querySelectorAll('.search-result-bucket__annotation-cards-container'); for ( var i=1; i<cards.length; i++ ){ var card = cards[i]; var klass = card.getAttribute('class'); if ( klass.indexOf('is-expanded') == -1 ) { card.setAttribute('class', 'search-result-bucket__annotation-cards-container is-expanded'); } }}())">ap_expand</a>
</p>

<p>
Activity pages collapser

<a href="javascript:(function(){var cards = document.querySelectorAll('.search-result-bucket__annotation-cards-container, is-expanded'); for ( var i=1; i<cards.length; i++ ){ var card = cards[i]; card.setAttribute('class', 'search-result-bucket__annotation-cards-container'); } }())">ap_collapse</a>


<p>
Send current page to via:

<a href="javascript:(function(){location.href='https://via.hypothes.is/h/'+location.href}())">h via</a>


<p>
Look up current page on stream:

<a href="javascript:(function(){location.href='https://hypothes.is/stream?q=uri:'+encodeURIComponent(location.href)}())">h stream uri</a>
</p>

<p>
Look up current page on api:

<a href="javascript:(function(){location.href='https://hypothes.is/api/search?uri='+encodeURIComponent(location.href)}())">h api uri</a>
</p>

<p>
Format API results:

 <a href='javascript:(function(f){var g;var c=(function(){var l={trace:function o(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,"$accept":0,"$end":1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function j(v,s,r,w,p,t,q){var u=t.length-1;switch(p){case 1:this.$=v;break;case 2:this.$=Number(v);break;case 3:this.$=null;break;case 4:this.$=true;break;case 5:this.$=false;break;case 6:return this.$=t[u-1];break;case 13:this.$={};break;case 14:this.$=t[u-1];break;case 15:this.$=[t[u-2],t[u]];break;case 16:this.$={};this.$[t[u][0]]=t[u][1];break;case 17:this.$=t[u-2];t[u-2][t[u][0]]=t[u][1];break;case 18:this.$=[];break;case 19:this.$=t[u-1];break;case 20:this.$=[t[u]];break;case 21:this.$=t[u-2];t[u-2].push(t[u]);break}},table:[{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],12:1,13:2,15:7,16:8,17:[1,14],23:[1,15]},{1:[3]},{14:[1,16]},{14:[2,7],18:[2,7],22:[2,7],24:[2,7]},{14:[2,8],18:[2,8],22:[2,8],24:[2,8]},{14:[2,9],18:[2,9],22:[2,9],24:[2,9]},{14:[2,10],18:[2,10],22:[2,10],24:[2,10]},{14:[2,11],18:[2,11],22:[2,11],24:[2,11]},{14:[2,12],18:[2,12],22:[2,12],24:[2,12]},{14:[2,3],18:[2,3],22:[2,3],24:[2,3]},{14:[2,4],18:[2,4],22:[2,4],24:[2,4]},{14:[2,5],18:[2,5],22:[2,5],24:[2,5]},{14:[2,1],18:[2,1],21:[2,1],22:[2,1],24:[2,1]},{14:[2,2],18:[2,2],22:[2,2],24:[2,2]},{3:20,4:[1,12],18:[1,17],19:18,20:19},{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],13:23,15:7,16:8,17:[1,14],23:[1,15],24:[1,21],25:22},{1:[2,6]},{14:[2,13],18:[2,13],22:[2,13],24:[2,13]},{18:[1,24],22:[1,25]},{18:[2,16],22:[2,16]},{21:[1,26]},{14:[2,18],18:[2,18],22:[2,18],24:[2,18]},{22:[1,28],24:[1,27]},{22:[2,20],24:[2,20]},{14:[2,14],18:[2,14],22:[2,14],24:[2,14]},{3:20,4:[1,12],20:29},{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],13:30,15:7,16:8,17:[1,14],23:[1,15]},{14:[2,19],18:[2,19],22:[2,19],24:[2,19]},{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],13:31,15:7,16:8,17:[1,14],23:[1,15]},{18:[2,17],22:[2,17]},{18:[2,15],22:[2,15]},{22:[2,21],24:[2,21]}],defaultActions:{16:[2,6]},parseError:function n(p,q){throw new Error(p)},parse:function m(Z){var K=this,ac=[0],N=[null],T=[],L=this.table,ag="",X=0,S=0,ae=0,aa=2,Q=1;this.lexer.setInput(Z);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;if(typeof this.lexer.yylloc=="undefined"){this.lexer.yylloc={}}var af=this.lexer.yylloc;T.push(af);if(typeof this.yy.parseError==="function"){this.parseError=this.yy.parseError}function M(q){ac.length=ac.length-2*q;N.length=N.length-q;T.length=T.length-q}function O(){var q;q=K.lexer.lex()||1;if(typeof q!=="number"){q=K.symbols_[q]||q}return q}var U,p,ad,V,J,R,W={},r,P,ah,ab;while(true){ad=ac[ac.length-1];if(this.defaultActions[ad]){V=this.defaultActions[ad]}else{if(U==null){U=O()}V=L[ad]&&L[ad][U]}if(typeof V==="undefined"||!V.length||!V[0]){if(!ae){ab=[];for(r in L[ad]){if(this.terminals_[r]&&r>2){ab.push("\""+this.terminals_[r]+"\"")}}var Y="";if(this.lexer.showPosition){Y="Parse error on line "+(X+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+ab.join(", ")}else{Y="Parse error on line "+(X+1)+": Unexpected "+(U==1?"end of input":("\""+(this.terminals_[U]||U)+"\""))}this.parseError(Y,{text:this.lexer.match,token:this.terminals_[U]||U,line:this.lexer.yylineno,loc:af,expected:ab})}if(ae==3){if(U==Q){throw new Error(Y||"Parsing halted.")}S=this.lexer.yyleng;ag=this.lexer.yytext;X=this.lexer.yylineno;af=this.lexer.yylloc;U=O()}while(1){if((aa.toString()) in L[ad]){break}if(ad==0){throw new Error(Y||"Parsing halted.")}M(1);ad=ac[ac.length-1]}p=U;U=aa;ad=ac[ac.length-1];V=L[ad]&&L[ad][aa];ae=3}if(V[0] instanceof Array&&V.length>1){throw new Error("Parse Error: multiple actions possible at state: "+ad+", token: "+U)}switch(V[0]){case 1:ac.push(U);N.push(this.lexer.yytext);T.push(this.lexer.yylloc);ac.push(V[1]);U=null;if(!p){S=this.lexer.yyleng;ag=this.lexer.yytext;X=this.lexer.yylineno;af=this.lexer.yylloc;if(ae>0){ae--}}else{U=p;p=null}break;case 2:P=this.productions_[V[1]][1];W.$=N[N.length-P];W._$={first_line:T[T.length-(P||1)].first_line,last_line:T[T.length-1].last_line,first_column:T[T.length-(P||1)].first_column,last_column:T[T.length-1].last_column};R=this.performAction.call(W,ag,S,X,this.yy,V[1],N,T);if(typeof R!=="undefined"){return R}if(P){ac=ac.slice(0,-1*P*2);N=N.slice(0,-1*P);T=T.slice(0,-1*P)}ac.push(this.productions_[V[1]][0]);N.push(W.$);T.push(W._$);ah=L[ac[ac.length-2]][ac[ac.length-1]];ac.push(ah);break;case 3:return true}}return true}};var k=(function(){var s=({EOF:1,parseError:function q(w,x){if(this.yy.parseError){this.yy.parseError(w,x)}else{throw new Error(w)}},setInput:function(w){this._input=w;this._more=this._less=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};return this},input:function(){var w=this._input[0];this.yytext+=w;this.yyleng++;this.match+=w;this.matched+=w;var x=w.match(/\n/);if(x){this.yylineno++}this._input=this._input.slice(1);return w},unput:function(w){this._input=w+this._input;return this},more:function(){this._more=true;return this},pastInput:function(){var w=this.matched.substr(0,this.matched.length-this.match.length);return(w.length>20?"...":"")+w.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var w=this.match;if(w.length<20){w+=this._input.substr(0,20-w.length)}return(w.substr(0,20)+(w.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var x=this.pastInput();var w=new Array(x.length+1).join("-");return x+this.upcomingInput()+"\n"+w+"^"},next:function(){if(this.done){return this.EOF}if(!this._input){this.done=true}var x,z,A,B;if(!this._more){this.yytext="";this.match=""}var w=this._currentRules();for(var y=0;y<w.length;y++){z=this._input.match(this.rules[w[y]]);if(z){B=z[0].match(/\n.*/g);if(B){this.yylineno+=B.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:B?B[B.length-1].length-1:this.yylloc.last_column+z[0].length};this.yytext+=z[0];this.match+=z[0];this.matches=z;this.yyleng=this.yytext.length;this._more=false;this._input=this._input.slice(z[0].length);this.matched+=z[0];x=this.performAction.call(this,this.yy,this,w[y],this.conditionStack[this.conditionStack.length-1]);if(x){return x}else{return}}}if(this._input===""){return this.EOF}else{this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function v(){var w=this.next();if(typeof w!=="undefined"){return w}else{return this.lex()}},begin:function u(w){this.conditionStack.push(w)},popState:function p(){return this.conditionStack.pop()},_currentRules:function r(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}});s.performAction=function t(w,z,x,A){var y=A;switch(x){case 0:break;case 1:return 6;break;case 2:z.yytext=z.yytext.substr(1,z.yyleng-2);return 4;break;case 3:return 17;break;case 4:return 18;break;case 5:return 23;break;case 6:return 24;break;case 7:return 22;break;case 8:return 21;break;case 9:return 10;break;case 10:return 11;break;case 11:return 8;break;case 12:return 14;break;case 13:return"INVALID";break}};s.rules=[/^\s+/,/^-?([0-9]|[1-9][0-9]+)(\.[0-9]+)?([eE][-+]?[0-9]+)?\b/,/^"(\\["bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^\0-\x09\x0a-\x1f"\\])*"/,/^\{/,/^\}/,/^\[/,/^\]/,/^,/,/^:/,/^true\b/,/^false\b/,/^null\b/,/^$/,/^./];s.conditions={INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:true}};return s})();l.lexer=k;return l})();if(typeof require!=="undefined"&&typeof exports!=="undefined"){exports.parser=c;exports.parse=function(){return c.parse.apply(c,arguments)};exports.main=function e(k){if(!k[1]){throw new Error("Usage: "+k[0]+" FILE")}if(typeof process!=="undefined"){var l=require("fs").readFileSync(require("path").join(process.cwd(),k[1]),"utf8")}else{var j=require("file").path(require("file").cwd());var l=j.join(k[1]).read({charset:"utf-8"})}return exports.parser.parse(l)};if(typeof module!=="undefined"&&require.main===module){exports.main(typeof process!=="undefined"?process.argv.slice(1):require("system").args)}}function b(k){var j=k.target;j.style.outline="2px solid #f00";g=j}function d(j){j.target.style.outline=""}function i(k,j){if("console" in window){if(j&&"warn" in window.console){console.warn(k)}else{console.log(k)}}else{if(j){alert(k)}}}function h(l){l.preventDefault();try{var j=c.parse(l.target.innerText);if(j){i("JSON is valid!");l.target.innerText=JSON.stringify(j,false,4).replace(/\\\\/g,"\\")}}catch(k){i(k.toString(),1)}return false}function a(j){if(j===null&&event.keyCode===27){f.detachEvent("mouseover",b);f.detachEvent("mouseout",d);f.detachEvent("click",h);f.detachEvent("keydown",a);g.style.outlineStyle="none"}else{if(j.which===27){f.removeEventListener("mouseover",b,true);f.removeEventListener("mouseout",d,true);f.removeEventListener("click",h,true);f.removeEventListener("keydown",a,true);g.style.outline="none"}}}if(f.addEventListener){f.addEventListener("mouseover",b,true);f.addEventListener("mouseout",d,true);f.addEventListener("click",h,true);f.addEventListener("keydown",a,true)}else{if(f.attachEvent){f.attachEvent("mouseover",b);f.attachEvent("mouseout",d);f.attachEvent("click",h);f.attachEvent("keydown",a)}}})(document);'>jsonlint</a> 


<p>
Look up selected text as user on stream:

<a href="javascript:(function(){location.href='https://hypothes.is/stream?q=user:'+window.getSelection().toString()}())">h user stream</a>
</p>
<p>
Look up selected text as user on api:

<a href="javascript:(function(){location.href='https://hypothes.is/api/search?user='+window.getSelection().toString()}())">h user api</a>
</p>
<p>
Activate the staging instance of H (against the live database):

<a href="javascript:%28function %28window%2C document%2C location%29 %7B%0A  var embedUrl %3D %27https%3A//stage.hypothes.is/embed.js%27%3B%0A  var isHTTPS %3D location.protocol.indexOf%28%27https%27%29 %3D%3D%3D 0%3B%0A  var isEmbedHTTPS %3D embedUrl.indexOf%28%27https%27%29 %3D%3D%3D 0%3B%0A  var isLocal %3D location.protocol %3D%3D%3D %27file%3A%27%3B%0A  var isPDF %3D location.pathname.toLowerCase%28%29.indexOf%28%27.pdf%27%29 > 0%3B%0A  var hasPDFjs %3D typeof window.PDFJS %21%3D%3D %27undefined%27%3B%0A  var embed%3B%0A%0A  if %28isLocal %26%26 %21isPDF%29 %7B%0A    window.alert%28%27Sorry%2C Hypothesis doesn%5C%27t work on this type of file. Only PDF%5C%27s can be annotated locally.%27%29%3B%0A    return%3B%0A  %7D%0A  if %28isPDF %26%26 %21hasPDFjs%29 %7B%0A    window.alert%28%27Sorry%2C this bookmarklet doesn%5C%27t work with PDF documents. Please use one of our browser extensions or the Firefox browser.%27%29%3B%0A    return%3B%0A  %7D%0A  if %28isHTTPS %26%26 %21isEmbedHTTPS%29 %7B%0A    window.alert%28%27Sorry%2C but this bookmarklet is unavailable on pages served with HTTPS at this time. Please contact support for further assistance.%27%29%3B%0A    return%3B%0A  %7D%0A%0A  window.hypothesisConfig %3D function %28%29 %7B%0A    return %7BshowHighlights%3A true%7D%3B%0A  %7D%3B%0A  embed %3D document.createElement%28%27script%27%29%3B%0A  embed.setAttribute%28%27src%27%2C embedUrl%29%3B%0A  document.body.appendChild%28embed%29%3B%0A%7D%29%28this%2C this.document%2C this.location%29%3B">h stage</a>
</p>

<h2>Hypothesis bookmarklet raw text (for creating "by hand" on iOS, Android, etc)</h2>

<p>
The text of the standard bookmarklet, for creating the H bookmarklet

<p><i>
javascript:(function(){window.hypothesisConfig=function(){return{showHighlights:true};};var%20d=document,s=d.createElement('script');s.setAttribute('src','https://hypothes.is/app/embed.js');d.body.appendChild(s)})();</i>

<p>
The text of an alternative via bookmarklet

<p>
<i>javascript:(function(){location.href='https://via.hypothes.is/'+location.href}())</i>

<p>
The text of the standard bookmarklet with sidebar auto-open

<p>
<i>javascript:(function(){window.hypothesisConfig=function(){return{showHighlights:true};};var d=document,s=d.createElement('script');s.setAttribute('src','https://hypothes.is/app/embed.js');d.body.appendChild(s);var timer = setInterval(function(){if (window.annotator){window.annotator.showFrame();clearInterval(timer);}},300)})();</i>

<p>
javascript:(function(){location.href='http://hyp.jonudell.info:8080/via2?url=' + location.href}());


</body>
</html>
